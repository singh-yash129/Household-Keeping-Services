<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
    <style>
        #category img {
            width: 70px;
            height: 70px;
            border: 2px solid grey;
            border-radius: 50%;
        }
        #category {
            display: flex;
            align-items: center;
            justify-content: space-between;
            
            margin: 40px;
        }
        #list {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            text-align: center;
            
        }
        .analysis {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            
        }
        .chart-container {
            width: 45%;
            margin-bottom: 20px;

           
        }
        .chart-container select{
            padding: 10px;
            font-weight: bold;
            border: 1px solid paleturquoise;

        }
        .chart-container canvas {
            display: block;
        }
        #3d-container {
            width: 100%;
            height: 500px;
            margin-top: 20px;
            display: none;
        }
        #results {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 30px;
            background-color: aliceblue;
            border: 1px solid rgb(42, 211, 161);
            border-radius: 10px;
            padding: 20px;
            

        }
      .campaign-box {
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 15px;
            width: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .campaign-box img {
            width: 100%;
            height: 150px;
            border-radius: 10px;
            object-fit: cover;
        }

        .campaign-box h4 {
            margin: 15px 0 10px;
            font-size: 18px;
        }

        .campaign-box p {
            margin-bottom: 10px;
            color: #555;
        }

        .campaign-box button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        .campaign-box button .material-symbols-outlined {
            margin-right: 5px;
        }

        .campaign-box button:hover {
            background-color: #218838;
        }
        #links a{
            display: flex;
            align-items: center;
            gap: 10px;
        }
    </style>
        <link rel="stylesheet"  href="https:/fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <div class="header">
        <div id="logo">
            <img src="{{url_for('static',filename='assets/logo.png')}}" alt="IEAS Logo">
        </div>
        <h2>Admin's Dashboard</h2>
        <div id="links">
            <a href="{{url_for('admin_list')}}"><span class="material-symbols-outlined">info</span>Info</a>
             <a href="{{url_for('verify_professioanal')}}"><span class="material-symbols-outlined">verified</span>Verify Professional and Services</a>
             <a href="{{url_for('payments')}}"><span class="material-symbols-outlined">payments</span>Payments</a>
             <a href="{{url_for('help_request')}}"><span class="material-symbols-outlined">help</span>help</a>
            <a href="{{ url_for('logout') }}"><span class="material-symbols-outlined">logout</span>Logout</a>
        </div>
    </div>
    <div class="box">
        <div id="stoms">
            <video autoplay muted loop class="background-video">
                <source src="https://videos.pexels.com/video-files/3141210/3141210-uhd_2560_1440_25fps.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <h1>Welcome Admin !!</h1>
            <h2>Explore Your Data with us....</h2>
        </div>
        
        <div id="category" onclick="window.location.href='{{url_for('admin_list')}}'" style="cursor: pointer;">
            <div id="list">
                <img src="{{url_for('static',filename='assets/logo.png')}}" alt="sponsor">
                <h4>Cleaning Service</h4>
            </div>
            <div id="list" >
                <img src="{{ url_for('static', filename='assets/plumbing.png') }}" alt="Influencer">
                <h4>Plumbing Service</h4>
            </div>
            <div id="list">
                <img src="{{ url_for('static', filename='assets/electrical.png') }}" alt="campaigns">
                <h4>Electric Service</h4>
            </div>
            <div id="list">
                <img src="{{ url_for('static', filename='assets/gardening.png') }}" alt="campaigns">
                <h4>Gardening Service</h4>
            </div>
            <div id="list">
                <img src="{{ url_for('static', filename='assets/painting.jpg') }}" alt="ads">
                <h4>Painting Service</h4>
            </div>
            <div id="list">
                <img src="{{ url_for('static', filename='assets/furniture_assembly.jpeg') }}" alt="ads">
                <h4>Furniture Service</h4>
            </div>
            <div id="list">
                <img src="{{ url_for('static', filename='icons/menu.png') }}" alt="flag">
                <h4>More</h4>
            </div>
        </div>

        <h2>Statistics:</h2>
        <hr>

            <div class="analysis">
                
                <div class="chart-container">
                    <h3>User Analysis: Customer vs Professional</h3>
                    <select id="sponsorChartType">
                        <option value="bar">Bar</option>
                        <option value="line">Line</option>
                        <option value="pie">Pie</option>
                        <option value="doughnut">Doughnut</option>
                        <option value="polarArea">Polar Area</option>
                    </select>
                    <canvas id="sponsorChart"></canvas>
                </div>
            
                
                <div class="chart-container">
                    <h3>Order Analysis</h3>
                    <select id="userChartType">
                        <option value="bar">Bar</option>
                        <option value="line">Line</option>
                        <option value="pie">Pie</option>
                        <option value="doughnut">Doughnut</option>
                        <option value="polarArea">Polar Area</option>
                    </select>
                    <canvas id="userChart"></canvas>
                </div>
            
        

            </div>
      

        <h2 style="margin: 25px;font-weight: bold;">Services :</h2><hr>
        <div id="results">
            {% for imp in service %}
                <div class="campaign-box">
                    <img src="{{ url_for('uploads', filename=imp.brand_logo) }}" alt="Campaign Image">
                    <h4>{{ imp.service_name }}</h4><span>Category : {{imp.service_category}}</span>
                   
                    <p>Price: {{imp.currency}} {{ imp.pricing }}</p>
                    <button onclick="window.location.href='{{ url_for('view_service', service_=imp.service_providing_code) }}'">
                        <span class="material-symbols-outlined">preview</span>View
                    </button>
                </div>
            {% endfor %}
        </div>
        
    </div>
    <script>

        const sponsorData = {
            labels: ["Customers", "Professionals"],
            datasets: [{
                label: 'Users Analysis',
                data: [50, 30], 
                backgroundColor: ['#4caf50', '#2196f3']
            }]
        };
    
        const orderData = {
            labels: ["Service Confirmed", "On the Way", "Work Completed", "Payment Done", "Pending"],          
            datasets: [{
                label: 'Order Analysis',
                data: [120, 50, 10], 
                backgroundColor: ['#8bc34a', '#ffc107', '#f44336']
            }]
        };
    
        function createChart(canvasId, data, type) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            return new Chart(ctx, {
                type: type,
                data: data,
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'top' },
                    },
                }
            });
        }
    
        document.getElementById('sponsorChartType').addEventListener('change', function () {
            const chartType = this.value;
            sponsorChart.destroy();
            sponsorChart = createChart('sponsorChart', sponsorData, chartType);
        });
    
        document.getElementById('userChartType').addEventListener('change', function () {
            const chartType = this.value;
            userChart.destroy();
            userChart = createChart('userChart', orderData, chartType);
        });
    
        let sponsorChart = createChart('sponsorChart', sponsorData, 'bar');
        let userChart = createChart('userChart', orderData, 'bar');
    </script>
<script>
    async function fetchChartData() {
        try {
            const response = await fetch('/chart-data');
            const data = await response.json();

           
            sponsorChart.data.labels = data.sponsorData.labels;
            sponsorChart.data.datasets[0].data = data.sponsorData.data;
            sponsorChart.update();

            userChart.data.labels = data.orderData.labels;
            userChart.data.datasets[0].data = data.orderData.data;
            userChart.update();
        } catch (error) {
            console.error('Error fetching chart data:', error);
        }
    }

    window.onload = fetchChartData;
</script>
    
</body>
</html>
