<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign-Up | Household Services</title>
    <link rel="stylesheet" href="{{url_for('static',filename='css/sign-up.css')}}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="{{url_for('static',filename='css/header.css')}}">
    <link rel="stylesheet"  href="https:/fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <style>
        .notification {
    position: fixed;
    bottom: 50px;
    right: 20px;
    padding: 10px 20px;
    border-radius: 5px;
    font-size: 16px;
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
    z-index: 1000;
}

.notification.success {
    background-color: #4CAF50;
    color: white;
    opacity: 1;
}

.notification.error {
    background-color: #F44336;
    color: white;
    opacity: 1;
}

    </style>
</head>
<body>
    <div class="header">
        <div id="logo">
            <img src="{{ url_for('static', filename='assets/logo.png') }}" alt="">
            <h3>Service Bucket</h3>
        </div>
        <div id="links">
            <a href="{{url_for('account')}}"><span class="material-symbols-outlined">account_circle</span>Account</a>
            <a href="{{url_for('privacy_policy')}}"><span class="material-symbols-outlined">security</span>Privacy Policy</a>
            <a href="{{url_for('about')}}"><span class="material-symbols-outlined">info</span>About</a>
            <a href="{{url_for('help')}}"><span class="material-symbols-outlined">help</span>Help</a>
        </div>
    </div>
    <div id="container" class="container">
        <div class="form-wrapper">
            <div class="sign-up form-container" >
                <form action="{{url_for('registration',data='customer')}}" method="post">
                    <h3>Create Account as Customer</h3>
                    <label for="Email">Email :</label>
                    <input type="email" name="email" id="email-customer" placeholder="Enter your email" required>
                    <label for="username">Username :</label>
                    <input type="text" name="username" id="username-customer" placeholder="Choose a username" required>
                    <label for="password">Password :</label>
                    <input type="password" name="password" id="password-customer" placeholder="Choose a password" required>
                    <label for="cnf-password">Confirm-Password :</label>
                    <input type="password" name="cnf-password" id="cnf-password-customer" placeholder="Confirm your password" required>
                    <button type="submit" class="btn">Create Account</button>
                </form>
            </div>
            <div class="sign-in form-container">
                <form action="{{url_for("registration",data='professional')}}" method="post">
                <h3>Create Account as Service Professional</h3>
                <label for="Email">Email :</label>
                <input type="email" name="email" id="email-professional" placeholder="Enter your email" required> 
                <label for="gstin">GST-No :</label>
                <input type="number" name="gstin" id="gstin-professional" placeholder="Enter GST number" required>
                <label for="uan_no">UAN-No :</label>
                <input type="number" name="uan_no" id="uan_no-professional" placeholder="Enter UAN number" required>
                <label for="username">Username :</label>
                <input type="text" name="username" id="username-professional" placeholder="Choose a username" required>
                <label for="password">Password :</label>
                <input type="password" name="password" id="password-professional" placeholder="Choose a password" required>
                <label for="cnf-password">Confirm-Password :</label>
                <input type="password" name="cnf-password" id="cnf-password-professional" placeholder="Confirm your password" required>
                <button type="submit" class="btn">Create Account</button>
                </form>
            </div>
        </div>
        <div class="toggle-container">
            <div class="toggle">
                <div class="toggle-panel toggle-left">
                    <h1>Welcome Back!</h1>
                    <p>Register to Provide Services and make other life easy.</p>
                    <button class="btn toggle-btn" id="services">Sign Up</button><br>
                    <h5>or</h5>
                    <p>Already have an account? Sign in to continue.</p>
                    <button class="btn toggle-btn" id="login" onclick="window.location.href='/login'">Sign In</button>
                </div>
                <div class="toggle-panel toggle-right">
                    <h1>Hello, Friend!</h1>
                    <p>Register to start using our services and enjoy all features.</p>
                    <button class="btn toggle-btn" id="customer">Sign Up</button><br>
                    <h5>or</h5>
                    <p>Already have an account? Sign in to continue.</p>
                    <button class="btn toggle-btn" id="login" onclick="window.location.href='/login'">Sign In</button>
                </div>
            </div>
        </div>
    </div>
    <div id="notify" class="notification"></div>
    <script src="{{url_for('static',filename='js/sign-up.js')}}"></script>

    <script>
document.addEventListener("DOMContentLoaded", () => {
    const formContainers = document.querySelectorAll("form");
    const notifyContainer = document.getElementById("notify");

    formContainers.forEach(form => {
        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const formData = new FormData(form);
            const formAction = form.getAttribute("action");

            try {
                const response = await fetch(formAction, {
                    method: "POST",
                    body: formData
                });

                // If the response is ok and there is a redirect
                if (response.redirected) {
                    window.location.href = response.url;
                } else if (response.ok) {
                    // Only parse JSON if response is not redirected and is ok
                    const result = await response.json();
                    showNotification(result.success, "success");
                    form.reset();
                } else {
                    // Handle JSON error response
                    const result = await response.json();
                    showNotification(result.error, "error");
                }
            } catch (error) {
                showNotification("An unexpected error occurred.", "error");
            }
        });
    });

    function showNotification(message, type) {
        notifyContainer.innerText = message;
        notifyContainer.className = `notification ${type}`;
        setTimeout(() => {
            notifyContainer.innerText = "";
            notifyContainer.className = "notification";
        }, 5000);
    }
});

    </script>
</body>
</html>
